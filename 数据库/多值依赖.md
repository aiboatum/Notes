# 多值依赖

多值依赖是和 4NF 相关的一个概念，即 4NF 消除了属性之间的『非平凡』且『非函数依赖』的多值依赖。

首先明确的是，**函数依赖是多值依赖的一个特殊情况**。

定义1：设 R(U) 是属性集 U 上的一个关系模式。X，Y，Z 是 U 的子集，并且 **Z = U - X - Y**。关系模式 R(U) 中多值依赖 X→→Y 成立，当且仅当对 R(U) 的任一关系 r，给定的一对 (x,z) 值，有 **一组**（也可以是一个） Y 的值，这组值仅仅决定于 x 值而与 z 值无关。

现在我们给出一个例子，假设有以下关系模式（非规范化），

| 课程 C |  教师 T   |            参考书 B            |
| :----: | :-------: | :----------------------------: |
|  物理  | 李勇 王军 | 普通物理学 光学原理 物理习题集 |
|  数学  | 李勇 张平 |   数学分析 微分方程 高等代数   |

当然从语义中可以看出，C→→T 成立，而且 C→→B 也成立。即一个 C 可以决定多个 T，一个 C 可以决定多个 B。

我们从定义1 来思考为什么是这样的？下面给出其规范化的关系模式：

| 课程 C | 教师 T |  参考书 B  |
| :----: | :----: | :--------: |
|  物理  |  李勇  | 普通物理学 |
|  物理  |  李勇  |  光学原理  |
|  物理  |  李勇  | 物理习题集 |
|  物理  |  王军  | 普通物理学 |
|  物理  |  王军  |  光学原理  |
|  物理  |  王军  | 物理习题集 |
|  数学  |  李勇  |  数学分析  |
|  数学  |  李勇  |  微分方程  |
|  数学  |  李勇  |  高等代数  |
|  数学  |  张平  |  数学分析  |
|  数学  |  张平  |  微分方程  |
|  数学  |  张平  |  高等代数  |

这里可以看到，对于一个（物理，光学原理）有一组 T 值 {李勇，王军}，这组值仅仅决定于课程 C 上的值，即物理。**也就是说**，对于另一个（物理，普通物理学），它对应的一组 T 仍然是 {李勇，王军}，尽管此时的 B 的值改变，但是 T 仍然不变。因此 C→→T，同理 C→→B。

定义2：在 R(U) 的任一关系 r 中，如果存在元组 t、s 使得 t[X]=S[X]，那么必然存在元组 $w,v\in r$（w，v可以和 t、s 相同），使得 w[X]=V[X]=T[X]，而 w[Y]=t[Y]，w[Z]=S[Z]，v[Y]=S[Y]，v[Z]=t[Z]（**即交换 s、t 元组的 Y 值所得的两个新元组必然在 r 中**），则 X→→Y。其中，Z=U-X-Y。


