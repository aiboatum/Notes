<a id="markdown-1-数据库" name="1-数据库"></a>
# 1. 数据库
<!-- TOC -->

- [1. 数据库](#1-数据库)
    - [1.1. 为什么会出现数据库？](#11-为什么会出现数据库)
    - [1.2. 数据库的分类](#12-数据库的分类)
        - [1.2.1. 关系数据库](#121-关系数据库)
        - [1.2.2. 非关系数据库（NoSQL）](#122-非关系数据库nosql)
    - [1.3. 什么是数据库模式？](#13-什么是数据库模式)
        - [1.3.1. 数据库的三级模式](#131-数据库的三级模式)
    - [1.4. 关系模型](#14-关系模型)
    - [1.5. SQL](#15-sql)
        - [1.5.1. 视图](#151-视图)
        - [1.5.2. 基本表](#152-基本表)
    - [1.6. 数据模型](#16-数据模型)
        - [1.6.1. 概念模型概述](#161-概念模型概述)
    - [1.7. E-R 图](#17-e-r-图)
    - [1.8. 关系数据模型术语](#18-关系数据模型术语)

<!-- /TOC -->
> 数据库就是数据的集合。可视为电子化的文件柜。（现阶段，可以和数据管理系统可以视为等同概念）。主要进行增删改查操作。

DB 是数据库，DBMS 是数据库管理系统。现在的 DBMS 一般都可以进行创建数据库，管理数据库等操作。两者不是割裂开来的概念。

简单来看，数据库用来存储数据，由表构成。如EXCEL一样。

数据库实际上就是一个文件的集合，按照特定的格式把数据组织存储起来。

<a id="markdown-11-为什么会出现数据库" name="11-为什么会出现数据库"></a>
## 1.1. 为什么会出现数据库？

在操作系统出现之后，随着计算机应用范围的扩大、需要处理的数据迅速膨胀。最初，数据与程序一样，以简单的文件作为主要存储形式。以这种方式组织的数据在逻辑上更简单，但可扩展性差，访问这种数据的程序需要了解数据的具体组织格式。当系统数据量大或者用户访问量大时，应用程序还需要解决数据的完整性、一致性以及安全性等一系列的问题。因此，必须开发出一种系统软件，它应该能够像操作系统屏蔽了硬件访问复杂性那样，屏蔽数据访问的复杂性。由此产生了数据管理系统，即数据库。

另，附上知乎回答：
数据库：是存放和管理数据的工具，数据库也是从写文件的级别发展过来的，当时无数据库这一概念，发现：
1. 文件的读写每个人都要写一套程序或方法，也即接口不一样；
2. 文件系统的管理成为问题，尤其当文件多的时候；
3. 文件系统中文件之间的关系无法体现出来；
4. 文件系统中文件内数据之间的关系无法体现出来；

至少有以上4点，然后就慢慢提炼出一个数据库的概念（比如开发接口ODBC等通用开发接口），先从非关系型数据库开始的（也即现在的名称：nosql）层->图->关系型->关系面向对象混合型->面向对象数据库...理论和产品都是按这个路线发展的...
referece: [怎么简单地理解数据库的概念？ - mysqlops的回答 - 知乎](https://www.zhihu.com/question/19904870/answer/13337293)

<a id="markdown-12-数据库的分类" name="12-数据库的分类"></a>
## 1.2. 数据库的分类

随着数据库技术与其他分支学科技术的结合，出现了多种新型数据库，例如：与分布处理技术结合产生的分布式数据库、与并行处理技术结合产生的并行数据库、与人工智能结合产生的演绎数据库、与多媒体技术结合产生的多媒体数据库。另外，数据库技术应用于特定的领域，出现了工程数据库、 地理数据库、统计数据库、空间数据库等特定领域数据库。

<a id="markdown-121-关系数据库" name="121-关系数据库"></a>
### 1.2.1. 关系数据库

关系数据库可以理解为：多张表+各表之间的关系。
1. 关系数据库中的表？
每个表有行（记录），列（字段）。并且每个表有一个标识，即主键，来标识数据的唯一性。
2. 各表之间如何建立联系？
联结。通过对应字段建立联结。
3. 关系数据主要有？
- MySQL
- Microsoft Access
- Microsoft SQL Server
- Oracle

<a id="markdown-122-非关系数据库nosql" name="122-非关系数据库nosql"></a>
### 1.2.2. 非关系数据库（NoSQL）

- MongoDB
- Redis

referencce:
1. [数据库-Wikipedia](https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E5%BA%93)
2. [最通俗易懂的理解什么是数据库 - 猴子的文章 - 知乎](https://zhuanlan.zhihu.com/p/46334459)

<a id="markdown-13-什么是数据库模式" name="13-什么是数据库模式"></a>
## 1.3. 什么是数据库模式？

> 架构（英语：Schema，又称模式），台湾翻译为纲要，在数据库系统中是形式语言描述的一种结构，是对象的集合，可包含各种对象如：表、字段、关系模型、视图、索引、包、存储过程、子程序、队列、触发器、数据类型、序列、物化视图、同义词（synonym）、database link、directory、XML schema等。

在关系型数据库中，分三级：database, schema, table。即一个数据库下面可以包含多个 schema（这里和下面介绍的三级模式又有所区别，不能等同），一个 schema 下可以包含多个数据库对象，比如表、存储过程、触发器等。但并非所有数据库都实现了 schema 这一层，比如 mysql 直接把 schema 和 database 等效了，PostgreSQL、Oracle、SQL server等的 schema 也含义不太相同。

reference:
1. [在数据库中，schema、catalog分别指的是什么？ - 时间轨迹的回答 - 知乎](https://www.zhihu.com/question/20355738/answer/1241628708)
2. [数据库模式-Wikipedia](https://zh.wikipedia.org/wiki/%E7%B6%B1%E8%A6%81_(%E8%B3%87%E6%96%99%E5%BA%AB))

总结：即一个数据库可以有多个 schema，每个 schema 可以指明该 schema 下的数据是如何组织的，如何索引的，权限是怎么样的等等。或者说是描述数据的逻辑结构和特征。

> :exclamation:这和下面介绍的关系的模式不是等同概念。简单认为，关系模式的集合组成数据库模式（虽然不那么严谨）。


<a id="markdown-131-数据库的三级模式" name="131-数据库的三级模式"></a>
### 1.3.1. 数据库的三级模式

这里的三级模式不如理解为数据库的三个『层次』，因为 DBMS 就是从三个层次管理数据：
- 外部层次：用户看到的数据，因此称为**用户层次**
- 概念层次：DBMS 中全局管理的数据，以及数据之间的约束和其他一起东西，所以又称为**逻辑层次**
- 内部层次：内部层次的数据是存储在介质上的数据，包括存储路径、存储方式、索引方式等，所以又叫**物理层次**

而『模式』，是『数据的结构性描述』，所以对于不同层次的数据，就对应着不同的模式，分别是外模式（用户模式）、模式（概念模式、逻辑模式）、内模式（物理模式）。

一般来说，在一个数据库系统中，『模式』和『内模式』都只能有一个，但『外模式』可以有很多个。原因在于，模式是对所有数据的全局性的结构描述，所以只能有一种形式。例如，一个学校的数据库中存放所有学生、课程和选课记录的信息。我们可以用三张表存放所有的数据。但是，存放学生数据的时候，我们只能够选取某一种特定的结构对学生的信息进行描述。而不能多种不同的结构共存（比如两种不同结构的学生表，存放的都是所有学生的信息）。所以『模式』只能有一个。同样的，介质上存放的数据，也只能选取某一种特定的存储模式，即存储路径如何、存储方式（二进制/文本）、索引方式（聚簇索引/普通索引）等等。

至于『外模式』，是以『视图』的形式展现给用户的。这里的『视图』不是我们平时说的 UI，而是指数据库中的视图，又叫『虚表』，是相对于『基本表』来说的。这里的基本表指的就是我们在建立数据库的时候需要创建的那些数据表(用 `CREATE TABLE` 创建出来的)，而视图是对这些基本表中的数据的某种展现形式，是这些数据的一个子集，但不限于某张表中的数据的子集，也可以是张表联合起来进行显示的一组数据。比如在一个学校的教务系统中，我们希望每个学生只能够看到自己的成绩，普通老师可以看到他/她教的学生的成绩，系主任可以看到这个系中所有学生的成绩,校长可以看到学校中每个学生的成绩。那么我们可以基于所有学生的成绩数据，针对于不同权限的用户选取不同的子集，这个子集就是所谓的『视图』。 但需要注意的是，「视图」本身并不「实际」存放数据，而只是对于如何选取数据的一种描述，这也是所谓的「虚表」。 当全局数据改变的时候，视图中的数据也会随之改变。通过外模式，可以让不同的用户(包括应用程序)看到他们希望看到的(比如可以同时看到学生本人的信息及他/她的所有成绩与对应的课程的信息，而这些数据实际上是分别存在于不同的数据表中的)，或是我们希望他们看到的数据(通过不同的子集来实现)。

总而言之，三种层次的模式都是对于数据的描述，只不过描述的层次不同。

reference:
1. [如何理解数据库的三级模式？ - 刘慰的回答 - 知乎](https://www.zhihu.com/question/38737183/answer/93294527)


<a id="markdown-14-关系模型" name="14-关系模型"></a>
## 1.4. 关系模型

**关系**是**元组**的集合，而元组是值的列表。展示一个关系的方法就是将它的元组作为一个个的行列出来。列的头称为**属性**，表示每一个分量的含义。关系名、属性名、以及属性类型称作**该关系**的模式。

如"数据库系统实现"给出的例子，
|title|year|length| 
|:---:|:---:|:---:|
|star wars|1977|124|
|mighty ducks|1991|104|
|wayne's world|1992|95|

上面的表就可以看作一个关系。**该关系的模式**（不是数据库模式）为：
```
Movie(title,year,length)
```
其中 `title`，`year`，`length` 是属性。

关系表中的行称为**记录**，列称为**字段**。



<a id="markdown-15-sql" name="15-sql"></a>
## 1.5. SQL 

SQL 即，structured query language （结构化查询语言）。查主要通过 `select ... from ... where ...` 来表达，增删改通过 `INSERT, DELETE, UPDATE` 实现。

SQL 语法这里不再赘述。

<a id="markdown-151-视图" name="151-视图"></a>
### 1.5.1. 视图

视图，即不实际存储但在需要时从实际存储的关系构造出来的关系的描述。在上面的『三级模式』中介绍了外模式和视图的关系。以及视图具体的例子。

<a id="markdown-152-基本表" name="152-基本表"></a>
### 1.5.2. 基本表

基本表是模式（逻辑模式）的基本内容，每一个基本表都是一个实际存在的关系，即 `create table` 创建的表。


<a id="markdown-16-数据模型" name="16-数据模型"></a>
## 1.6. 数据模型

模型就是对现实中具体事物的抽象。数据模型即用来描述数据、组织数据和对数据进行操作的。

1. 概念模型：建模实现对现实世界的概念抽象
2. 逻辑模型和物理模型：
    - 逻辑模型包括网状、层次、关系和对象模型等，由设计人员按照计算机观点建模实现概念模型到适应某 DBMS 的逻辑模型的转变
    - 描述数据的存储方式和方法，DBMS 完成从逻辑到物理模型的转变

现实世界的数字化过程如下：
```
    [现实世界] --> [信息世界] : 抽象化
    [信息世界] --> [数据世界] : 数据化
```

<a id="markdown-161-概念模型概述" name="161-概念模型概述"></a>
### 1.6.1. 概念模型概述

1. 实体 （entity）：一个老师，一个学生，一个操作流程等都是实体。

2. 属性（attribute）：对客观事物特征的反映，是实体具有的某个特征。如学生实体中有学号属性、姓名属性、性别属性等等。属性有『属性名称』和『属性值』之分，如属性名称为“姓名”，属性值为“张三”。

3. **域（domain）**：属性的取值范围称为域。例如，性别属性的属性值只能为“男”或“女”。

4. 实体集（entity set）：所有属性名完全相同的实体集合在一起，称为实体集。比如学生实体集，教师实体集。

5. 实体型（entity type）：实体集名称以及其所有属性名的集合称为实体型。如，`学生（学号，姓名，性别，年龄，所在系）` 就是学生实体集的实体型。

6. 联系（relationship）：现实世界中，事物之间有着错综复杂的联系。反映在概念模型中，则有了实体集内部的联系和实体集之间的联系。也可以简单理解为实体中属性的联系和实体与实体之间的联系。
    - 『一对一』（1:1）
    如果对于实体集 A 中的每个实体，实体集 B 中至少有一个（也可以没有）实体与之联系，**反之亦然**，则称实体集 A 和 B 具有 1:1 的联系。如一个部门有一个经理，而每个经理只在一个部门任职，则部门与经理的联系是一对一的。
    - 『一对多』（1:N）
    如果对于实体集 A 中每一个实体，实体集 B 中有 N 个实体与之联系，反之，对于实体集 B 中的每个实体，A 中**至多只有一个**实体与之联系。某校教师与课程之间存在一对多的联系“教”，即每位教师可以教多门课程，但是每门课程只能由一位教师来教。
    - 『多对多』（M:N）
    如果对于实体集 A 中的每一个实体，实体集 B 中有 N 个实体与之联系，反之，对于实体集 B 中的每一个实体，实体集 A 中也有 M 个实体与之联系。如一门课程可以被多个学生选择，一个学生可以选择多门课程。

<a id="markdown-17-e-r-图" name="17-e-r-图"></a>
## 1.7. E-R 图

**E-R** 图，即实体-联系图。主要包含实体、关系、属性三个基本组成部分。这里再次引用 [ER模型-Wikipedia](https://zh.wikipedia.org/wiki/ER%E6%A8%A1%E5%9E%8B) 中的定义，来回顾三者的定义。

实体（Entity）表示一个离散对象。实体可以被（粗略地）认为是名词，如计算机、雇员、歌曲、数学定理。关系描述了两个或更多实体相互如何关联。联系可以被（粗略地）认为是动词，如：在公司和计算机之间的拥有关联，在雇员和部门之间的管理关联，在演员和歌曲之间的表演关联，在数学家和定理之间的证明关联。实体绘制为矩形，联系绘制为菱形。
- 两个有联系的实体

![](image/Erd-entity-relationship-example1.svg)

- 带有一个属性的实体

![](image/193px-Erd-entity-with-attribute.svg)

- 带有一个属性的联系

![](image/Erd-relationship-with-attribute.svg)

每个实体（除非是弱实体）都必须有一个唯一标识属性的最小化集合。这个集合叫做实体的主键。
- 主键

![](image/Erd-id-as-primary-key.svg)

- ER 图示意

![](image/ER_Diagram_MMORPG.png)

<a id="markdown-18-关系数据模型术语" name="18-关系数据模型术语"></a>
## 1.8. 关系数据模型术语

1. 关系：即一张表
2. 属性：每一列为一个属性，包括属性名和属性名称
3. 字段和记录：行为记录，列为字段（field）
4. 元组：一行数据为一个元组
5. 候选码：一个表中某个属性（字段）或某几个属性能唯一标识各个记录（行），且不包含多余的属性，则称之为候选码，简称码（key）
6. 主码（primary key），又称主键：一个关系中有多个候选码时，则取其中一个为主码。每个关系有且仅有一个 primary key。
    :exclamation:当一个两个表的主键**完全相同**时，就要慎重思考这两个表的关系，是否需要划分两个表
7. 外部码，又称外键：若 A 是基本关系 R1 的属性（组），但不是 R1 的码，且 A 与基本关系 R2 的码 K 相对应，则称 A 是 R1 的外键。

比如有如下属性组：
```
学生表（学号，姓名，性别，班级）        -- 学号是 primary key
课程表（课程编号，课程名，学分）        -- 课程编号是一个主键
成绩表（学号，课程号，成绩）            -- 这里的（学号，课程号）是主键
```
成绩表中的学号不是成绩表中的主键，但它和学生表中的学号相对应，并且学生表中的学号是学生表的主键，则称成绩表中的学号是学生表的外键。

外键主要用于和另一个表的关联。用于保持数据的一致性。并且一个表可以有多个外键，也可以没有外键。一个表的外键一定是另一个表的主键。